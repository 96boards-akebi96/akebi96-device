
on fs
    export OMX_BELLAGIO_REGISTRY /vendor/etc/omxregister

    mount_all /vendor/etc/fstab_boot.sc1401aj1
    swapon_all /vendor/etc/fstab.sc1401aj1

on early-init
    mount debugfs debugfs /sys/kernel/debug
    chmod 755 /sys/kernel/debug
    

on init
    # See storage config details at http://source.android.com/tech/storage/
    #mkdir /storage/sdcard 0555 root root

    #export EXTERNAL_STORAGE /storage/sdcard

    # Support legacy paths
    #symlink /storage/sdcard /sdcard
    #symlink /storage/sdcard /mnt/sdcard

    # mkdir /tmp 01775 root root
    # mount tmpfs tmpfs /tmp size=25m

    mkdir /dev/cpuctl/bg_non_interactive
    chown system system /dev/cpuctl/bg_non_interactive/tasks
    chmod 0666 /dev/cpuctl/bg_non_interactive/tasks

    # KSM config
    write /sys/kernel/mm/ksm/pages_to_scan 100
    write /sys/kernel/mm/ksm/sleep_millisecs 500
    write /sys/kernel/mm/ksm/run 1

    write /sys/block/zram0/comp_algorithm lz4
    write /sys/block/zram0/max_comp_streams 2

    # Swap in only 1 page at a time
    write /proc/sys/vm/page-cluster 0

on boot
    chmod 777 /sys/kernel/debug
    chmod 777 /sys/kernel/debug/tracing
    chmod 777 /sys/kernel/debug/regmap
    chown system system /sys/power
    chmod 0770 /sys/power
    chmod 0666 /sys/kernel/debug/tracing/trace_marker

    # add a cpuset for the camera daemon
    # we want all cores for camera
    mkdir /dev/cpuset/camera-daemon
    write /dev/cpuset/camera-daemon/cpus 0-3
    write /dev/cpuset/camera-daemon/mems 0
    chown system system /dev/cpuset/camera-daemon
    chown system system /dev/cpuset/camera-daemon/tasks
    chmod 0664 /dev/cpuset/camera-daemon/tasks

    # Update DVR cpusets to boot-time values.
    write /dev/cpuset/kernel/cpus 0-3
    write /dev/cpuset/system/cpus 0-3
    write /dev/cpuset/system/performance/cpus 0-3
    write /dev/cpuset/system/background/cpus 0-3
    write /dev/cpuset/system/cpus 0-3
    write /dev/cpuset/application/cpus 0-3
    write /dev/cpuset/application/performance/cpus 0-3
    write /dev/cpuset/application/background/cpus 0-3
    write /dev/cpuset/application/cpus 0-3

# fake some battery state
    #setprop status.battery.state Slow
    #setprop status.battery.level 5
    #setprop status.battery.level_raw  50
    #setprop status.battery.level_scale 9

# enable Google-specific location features,
# like NetworkLocationProvider and LocationCollector
    #setprop ro.com.google.locationfeatures 1

    setprop ro.radio.noril yes
    stop ril-daemon

on post-fs
#on post-fs-data

    # set RLIMIT_MEMLOCK to 64MB
    setrlimit 8 67108864 67108864

    insmod /vendor/lib/modules/extra/ion-uniphier.ko

    insmod /vendor/lib/modules/extra/vocdrv-ld20.ko
    insmod /vendor/lib/modules/extra/mali_kbase.ko 

    insmod /vendor/lib/modules/extra/snd-soc-uniphier-aio2013.ko
    insmod /vendor/lib/modules/extra/uniphier-spdif_tx.ko
    insmod /vendor/lib/modules/kernel/drivers/usb/dwc3/dwc3.ko
    insmod /vendor/lib/modules/kernel/drivers/usb/dwc3/dwc3-uniphier.ko

    insmod /vendor/lib/modules/kernel/drivers/media/dvb-frontends/helene.ko
    insmod /vendor/lib/modules/kernel/drivers/media/dvb-frontends/sc1501a.ko
    insmod /vendor/lib/modules/kernel/drivers/media/platform/uniphier/uniphier-dvb.ko
    insmod /vendor/lib/modules/kernel/drivers/media/platform/uniphier/uniphier-ld20-mn884434-helene.ko

on boot
    insmod /vendor/lib/modules/kernel/drivers/net/ethernet/socionext/ave/ave.ko
    insmod /vendor/lib/modules/kernel/sound/core/snd-hwdep.ko
    insmod /vendor/lib/modules/kernel/sound/usb/snd-usbmidi-lib.ko
    insmod /vendor/lib/modules/kernel/sound/usb/snd-usb-audio.ko

on post-fs-data
    chmod 777 /sys/kernel/debug/tracing
    chown system shell /data/misc/adb/adb_keys
    chmod 640 /data/misc/adb/adb_keys
    setprop vold.post_fs_data_done 1

service DisplayManager /vendor/bin/display_manager
    class core
    user system
    group graphics
    writepid /dev/cpuset/system-background/tasks
